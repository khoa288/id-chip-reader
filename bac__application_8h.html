<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ID Chip Reader: include/access/bac_application.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ID Chip Reader
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('bac__application_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">bac_application.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for Basic Access Control (BAC) application functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;config.h&quot;</code><br />
</div>
<p><a href="bac__application_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:acfb6bf4a00041090d4f4bd36e1f1d2bc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#acfb6bf4a00041090d4f4bd36e1f1d2bc">ACCESS_BAC_APPLICATION_H_</a></td></tr>
<tr class="separator:acfb6bf4a00041090d4f4bd36e1f1d2bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aaa85ce1626d8c0ab3a551fedc59c6c54"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#aaa85ce1626d8c0ab3a551fedc59c6c54">KeySeedCalculate</a> (unsigned char mrzInformation[], unsigned char mrzKeySeed[16])</td></tr>
<tr class="memdesc:aaa85ce1626d8c0ab3a551fedc59c6c54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Key Seed for generating Session Key.  <a href="bac__application_8h.html#aaa85ce1626d8c0ab3a551fedc59c6c54">More...</a><br /></td></tr>
<tr class="separator:aaa85ce1626d8c0ab3a551fedc59c6c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9c2b33f521059eaab2d9468f0f3edca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#ab9c2b33f521059eaab2d9468f0f3edca">SessionKeyGenerate</a> (unsigned char keySeed[16], unsigned char encryptKeyBuf[16], unsigned char macKeyBuf[16])</td></tr>
<tr class="memdesc:ab9c2b33f521059eaab2d9468f0f3edca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate Session Key from Key Seed.  <a href="bac__application_8h.html#ab9c2b33f521059eaab2d9468f0f3edca">More...</a><br /></td></tr>
<tr class="separator:ab9c2b33f521059eaab2d9468f0f3edca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bbebaede55c88e5a54a4906da0a2bee"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#a1bbebaede55c88e5a54a4906da0a2bee">InitReader</a> (void)</td></tr>
<tr class="memdesc:a1bbebaede55c88e5a54a4906da0a2bee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find, connect and start session on reader.  <a href="bac__application_8h.html#a1bbebaede55c88e5a54a4906da0a2bee">More...</a><br /></td></tr>
<tr class="separator:a1bbebaede55c88e5a54a4906da0a2bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0bde8027316769a7eddd498c72acb5d"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#ac0bde8027316769a7eddd498c72acb5d">SelectApplication</a> (void)</td></tr>
<tr class="memdesc:ac0bde8027316769a7eddd498c72acb5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select Application for Basic Access Control.  <a href="bac__application_8h.html#ac0bde8027316769a7eddd498c72acb5d">More...</a><br /></td></tr>
<tr class="separator:ac0bde8027316769a7eddd498c72acb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5731444cb29e6df9fc501e5682999d04"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#a5731444cb29e6df9fc501e5682999d04">GetChallenge</a> (unsigned char getChallengeResponse[10], int getChallengeResponseSize)</td></tr>
<tr class="memdesc:a5731444cb29e6df9fc501e5682999d04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get Challenge for Basic Access Control.  <a href="bac__application_8h.html#a5731444cb29e6df9fc501e5682999d04">More...</a><br /></td></tr>
<tr class="separator:a5731444cb29e6df9fc501e5682999d04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf0105df61e01468deb7e01c9c3c3301"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#acf0105df61e01468deb7e01c9c3c3301">ExternalAuthenticate</a> (unsigned char getChallengeResponse[10], unsigned char encryptKey[16], unsigned char macKey[16], unsigned char sessionKeyEncrypt[16], unsigned char sessionKeyMac[16], unsigned char sendSequenceCounter[8])</td></tr>
<tr class="memdesc:acf0105df61e01468deb7e01c9c3c3301"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the EXTERNAL AUTHENTICATE operation with the smart card.  <a href="bac__application_8h.html#acf0105df61e01468deb7e01c9c3c3301">More...</a><br /></td></tr>
<tr class="separator:acf0105df61e01468deb7e01c9c3c3301"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a657527ca2b7aace969031a53de151b32"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#a657527ca2b7aace969031a53de151b32">ReadEFCOM</a> (unsigned char sessionKeyEncrypt[16], unsigned char sessionKeyMac[16], unsigned char sendSequenceCounter[8])</td></tr>
<tr class="memdesc:a657527ca2b7aace969031a53de151b32"><td class="mdescLeft">&#160;</td><td class="mdescRight">External Authenticate to get Session Encrypt Key, MAC Key, and Send Sequence Counter for Secure Messaging.  <a href="bac__application_8h.html#a657527ca2b7aace969031a53de151b32">More...</a><br /></td></tr>
<tr class="separator:a657527ca2b7aace969031a53de151b32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a508b92082f67de4e66544830c908bf6f"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#a508b92082f67de4e66544830c908bf6f">ReadDG1</a> (unsigned char sessionKeyEncrypt[16], unsigned char sessionKeyMac[16], unsigned char sendSequenceCounter[8])</td></tr>
<tr class="memdesc:a508b92082f67de4e66544830c908bf6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read DG1.COM to get basic holder's information.  <a href="bac__application_8h.html#a508b92082f67de4e66544830c908bf6f">More...</a><br /></td></tr>
<tr class="separator:a508b92082f67de4e66544830c908bf6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0439408f14e7f2c0bababe6bbe873dd0"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="bac__application_8h.html#a0439408f14e7f2c0bababe6bbe873dd0">ReadDG2</a> (unsigned char sessionKeyEncrypt[16], unsigned char sessionKeyMac[16], unsigned char sendSequenceCounter[8], unsigned char imageFilePath[])</td></tr>
<tr class="memdesc:a0439408f14e7f2c0bababe6bbe873dd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read DG2.COM to get holder's image.  <a href="bac__application_8h.html#a0439408f14e7f2c0bababe6bbe873dd0">More...</a><br /></td></tr>
<tr class="separator:a0439408f14e7f2c0bababe6bbe873dd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for Basic Access Control (BAC) application functions. </p>
<dl class="section author"><dt>Author</dt><dd>Khoa Nguyen</dd></dl>
<p>This header file contains function declarations for performing Basic Access Control (BAC) operations on a smart card, such as selecting applications, getting challenges, and reading data groups. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acfb6bf4a00041090d4f4bd36e1f1d2bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfb6bf4a00041090d4f4bd36e1f1d2bc">&#9670;&nbsp;</a></span>ACCESS_BAC_APPLICATION_H_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ACCESS_BAC_APPLICATION_H_</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="acf0105df61e01468deb7e01c9c3c3301"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf0105df61e01468deb7e01c9c3c3301">&#9670;&nbsp;</a></span>ExternalAuthenticate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ExternalAuthenticate </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>getChallengeResponse</em>[10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>encryptKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>macKey</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyEncrypt</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyMac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sendSequenceCounter</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs the EXTERNAL AUTHENTICATE operation with the smart card. </p>
<p>This function sends an EXTERNAL AUTHENTICATE command to the smart card, which is used for mutual authentication between the card and the application. It computes necessary data, encrypts and decrypts information, verifies received data, and generates session keys (KS_Enc and KS_MAC) as well as the Send Sequence Counter (SSC).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">getChallengeResponse</td><td>Pointer to a 10-byte array containing the response from a previous GET CHALLENGE command. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryptKey</td><td>Pointer to a 16-byte array containing the encryption key (K_Enc). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">macKey</td><td>Pointer to a 16-byte array containing the MAC key (K_MAC). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sessionKeyEncrypt</td><td>Pointer to a 16-byte array where the generated encryption session key (KS_Enc) will be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sessionKeyMac</td><td>Pointer to a 16-byte array where the generated MAC session key (KS_MAC) will be stored. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sendSequenceCounter</td><td>Pointer to an 8-byte array where the initialized Send Sequence Counter (SSC) will be stored.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful reading, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="a5731444cb29e6df9fc501e5682999d04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5731444cb29e6df9fc501e5682999d04">&#9670;&nbsp;</a></span>GetChallenge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long GetChallenge </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>getChallengeResponse</em>[10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>getChallengeResponseSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get Challenge for Basic Access Control. </p>
<p>Requests a challenge from the smart card for BAC authentication. Returns a status code indicating success or failure in getting the challenge *</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">getChallengeResponse</td><td>The received challenge as an array of 10 unsigned chars. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">getChallenge</td><td>of getChallengeResponse array (should be 10).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful retrieval, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="a1bbebaede55c88e5a54a4906da0a2bee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bbebaede55c88e5a54a4906da0a2bee">&#9670;&nbsp;</a></span>InitReader()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long InitReader </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find, connect and start session on reader. </p>
<p>Initializes the reader by finding it, connecting to it, and starting a session. Returns a status code indicating success or failure in initializing the reader.</p>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful initialization, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="aaa85ce1626d8c0ab3a551fedc59c6c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa85ce1626d8c0ab3a551fedc59c6c54">&#9670;&nbsp;</a></span>KeySeedCalculate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KeySeedCalculate </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>mrzInformation</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>mrzKeySeed</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Key Seed for generating Session Key. </p>
<p>Given MRZ information, this function calculates the key seed used to generate the session key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mrzInformation</td><td>The MRZ information as an array of unsigned chars. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mrzKeySeed</td><td>The calculated key seed as an array of 16 unsigned chars. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a508b92082f67de4e66544830c908bf6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a508b92082f67de4e66544830c908bf6f">&#9670;&nbsp;</a></span>ReadDG1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ReadDG1 </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyEncrypt</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyMac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sendSequenceCounter</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read DG1.COM to get basic holder's information. </p>
<p>Reads the DG1 data group from the smart card, which contains basic information about the holder, using secure messaging with provided session keys and send sequence counter. Returns a status code indicating success or failure in reading DG1 data group.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sessionKeyEncrypt</td><td>The session encryption key as an array of 16 unsigned chars for secure messaging. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sessionKeyMac</td><td>The session MAC key as an array of 16 unsigned chars for secure messaging. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sendSequenceCounter</td><td>The send sequence counter as an array of 8 unsigned chars for secure messaging, updated after each command/response exchange with the smart card.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful reading, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="a0439408f14e7f2c0bababe6bbe873dd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0439408f14e7f2c0bababe6bbe873dd0">&#9670;&nbsp;</a></span>ReadDG2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ReadDG2 </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyEncrypt</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyMac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sendSequenceCounter</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>imageFilePath</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read DG2.COM to get holder's image. </p>
<p>Reads the DG2 data group from the smart card, which contains the holder's image (in JPEG format), using secure messaging with provided session keys and send sequence counter. Saves the retrieved image as a JPEG file named "face_image.jpeg" in the current working directory. Returns a status code indicating success or failure in reading DG2 data group and saving the image file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sessionKeyEncrypt</td><td>The session encryption key as an array of 16 unsigned chars for secure messaging. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sessionKeyMac</td><td>The session MAC key as an array of 16 unsigned chars for secure messaging. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">sendSequenceCounter</td><td>The send sequence counter as an array of 8 unsigned chars for secure messaging, updated after each command/response exchange with the smart card. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">imageFilePath</td><td>The path to the image file to be saved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful reading and saving of the image, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="a657527ca2b7aace969031a53de151b32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a657527ca2b7aace969031a53de151b32">&#9670;&nbsp;</a></span>ReadEFCOM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long ReadEFCOM </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyEncrypt</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sessionKeyMac</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>sendSequenceCounter</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>External Authenticate to get Session Encrypt Key, MAC Key, and Send Sequence Counter for Secure Messaging. </p>
<p>Performs external authentication with the smart indicating success or failure in performing external authentication.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">getChallengeResponse</td><td>The received challenge as an array of 10 unsigned chars used in authentication. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryptKey</td><td>The encryption key as an array of 16 unsigned chars used in authentication. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">macKey</td><td>The MAC key as an array of 16 unsigned chars used in authentication get basic chip's information.</td></tr>
  </table>
  </dd>
</dl>
<p>Reads the EF.COM data group from card.</p>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful reading, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="ac0bde8027316769a7eddd498c72acb5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0bde8027316769a7eddd498c72acb5d">&#9670;&nbsp;</a></span>SelectApplication()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long SelectApplication </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Select Application for Basic Access Control. </p>
<p>Sends a command to select the BAC application on the smart card. Returns a status code indicating success or failure in selecting the application.</p>
<dl class="section return"><dt>Returns</dt><dd>A long value representing the status code. APP_SUCCESS indicates successful selection, otherwise an error code is returned. </dd></dl>

</div>
</div>
<a id="ab9c2b33f521059eaab2d9468f0f3edca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9c2b33f521059eaab2d9468f0f3edca">&#9670;&nbsp;</a></span>SessionKeyGenerate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SessionKeyGenerate </td>
          <td>(</td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>keySeed</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>encryptKeyBuf</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>macKeyBuf</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate Session Key from Key Seed. </p>
<p>Given a key seed, this function generates the session encryption and MAC keys.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">keySeed</td><td>The key seed as an array of 16 unsigned chars. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">encryptKeyBuf</td><td>The generated session encryption key as an array of 16 unsigned chars. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">macKeyBuf</td><td>The generated session MAC key as an array of 16 unsigned chars. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_bbc13ad43e2dd1fa7b2a97acf839132b.html">access</a></li><li class="navelem"><a class="el" href="bac__application_8h.html">bac_application.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
